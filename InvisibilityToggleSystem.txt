-- Roblox Invisibility System Script
-- Make sure to insert a RemoteEvent named "ToggleInvisibility" inside ReplicatedStorage.

-- 1. LocalScript (place inside StarterPlayer > StarterPlayerScripts)
-- This script creates a button to toggle invisibility for the player

-- Begin LocalScript
local ReplicatedStorage = game:GetService("ReplicatedStorage")
local Players = game:GetService("Players")
local toggleEvent = ReplicatedStorage:WaitForChild("ToggleInvisibility")

local player = Players.LocalPlayer

-- GUI Button
local ScreenGui = Instance.new("ScreenGui", player:WaitForChild("PlayerGui"))
local Button = Instance.new("TextButton", ScreenGui)

Button.Size = UDim2.new(0, 200, 0, 50)
Button.Position = UDim2.new(0.5, -100, 0.9, 0)
Button.Text = "Toggle Invisibility"
Button.BackgroundColor3 = Color3.fromRGB(0, 170, 255)
Button.TextColor3 = Color3.new(1,1,1)
Button.Font = Enum.Font.SourceSansBold
Button.TextSize = 24

local invisible = false

Button.MouseButton1Click:Connect(function()
    invisible = not invisible
    toggleEvent:FireServer(invisible)
    Button.Text = invisible and "Visible" or "Invisible"
end)
-- End LocalScript


-- 2. Script (place inside ServerScriptService)
-- This script listens to the RemoteEvent and hides/shows the player for all others

-- Begin Server Script
local ReplicatedStorage = game:GetService("ReplicatedStorage")
local toggleEvent = ReplicatedStorage:WaitForChild("ToggleInvisibility")

toggleEvent.OnServerEvent:Connect(function(player, makeInvisible)
    local character = player.Character
    if not character then return end

    for _, part in pairs(character:GetDescendants()) do
        if part:IsA("BasePart") and part.Name ~= "HumanoidRootPart" then
            part.Transparency = makeInvisible and 1 or 0
            part.CanCollide = not makeInvisible
        elseif part:IsA("Decal") then
            part.Transparency = makeInvisible and 1 or 0
        end
    end
end)
-- End Server Script
